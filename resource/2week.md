# AI 스터디 2주차 

이번 주에는 이전에 다뤘던 **선형 회귀(Linear Regression)** 문제와 **분류(Classification)** 문제에 대한 설명을 다룰 예정이다. 

먼저, 자신이 나무에 대한 정보가 아무것도 없다고 생각하자.
우리는 어떻게 학습을 하였을까?? 즉, **나무에 대한 정보가 없으면 나무라는 것 자체도 학습을 못했음**을 알 수가 있다.
우리가 나무라는 정보를 몰랐을 때로 돌아갔다고 쳤을 때 이를 컴퓨터의 세계로 옮겨보자. 

어느 컴퓨터로 하여금 매번 랜덤한 대상이 포함된 이미지를 던져줬을 때, 그것이 '나무인지 아닌지'를 구별할 수 있도록 학습를 시키고자 한다고 가정해봅시다. 
우리도 부모님이나 혹은 친구에게 '저게 나무야!!' 라는 것을 배웠듯이 컴퓨터라는 기계로 하여금 학습을 하도록 하려면 대단히 많은 수의 나무 이미지를 제시해줘야 합니다.

이러한 수 많은 예시들의 집합을 머신러닝에서는 **'데이터(Data)'**라고 부릅니다.

이 때 중요한 점은, 기계로 하여금 어느 대상의 이미지를 주고, 그것이 나무인지 아닌지 구별하도록 하기 위해서는, 나무 이미지뿐만 아니라 나무가 아닌 이미지도 줘서 **나무 맞는지 아닌지**에 대한 판단 척도를 제시해줘야 합니다.
따라서 실제로는 어떤 랜덤한 이미지를 주고 {'나무', '나무아님'} 이런식으로 표식을 붙여 그것의 정체를 나타내도록 하는데, 이를 **'레이블(Label)'**이라고 부릅니다.

다시 말해, 머신러닝(특히, 지도학습)에서는 수많은 (예시, 레이블) 쌍의 집합(Tuple)이 한 덩어리의 데이터가 되어 기계로 전달됩니다.

이것이 **분류(Classification)문제** 입니다.

그렇다면? **선형 회귀(Linear Regression) 문제**는 어떤걸 말할까요? 수치화된 데이터에 대한 분석을 통해 최적의 의사결정을 내리는 것과 같은 행위를 할 수 있는 것을 뜻합니다.
컴퓨터의 입장에서는 수치화된 데이터에 기반한 작업이 더 쉽습니다. 이 부분에 대한 예시를 채무 이행 여부에 대해서 설명해보겠습니다.

'충대머니'라는 대부업체에서는 수천명의 고객을 보유하고 있는데, 이들의 데이털르 바탕으로 하여 채무이행 기한이 임박한 이들이 3개월 내에 채무를 **이행할지/불이행할지** 여부를 맞추고자 합니다.
문제를 단순화하기 위해서 **'나이'와 '연봉' 정보**를 통하여 높은 정확도로 예측하는 컴퓨터를 학습하는데 성공하였다고 가정하겠습니다.


누누히 말씀드렸지만, 머신러닝을 위해서는 **데이터**가 필요합니다. 위에서, (예시, 레이블)로 데이터 집합이 이뤄진다고 하였는데 이 문제에 해당하면, **예시 = 나이와 연봉 / 레이블 = 채무 이행여부**로 이뤄짐을 알 수가 있습니다.
구체적인 예시로 '충대머니'에서는 3개월 내에 채무를 이행한 기록이 있거나, ㅎㄱ은 이행하지 못한 기록이 있는 고객들의 데이터를 활용하고자 한다 해보자.
예를 들어, 2019년 4월 27일에 대출한 29세 '김효중'씨는 연봉이 5천6백만원이며 채무를 이행한 기록이 있다.
        2018년에 2월 13일날 대출한 33세 '이민주'씨는 연봉이 3천3백만원인데 채무 이행 기한인 2018년 5월 3일까지 채무를 이행하지 못했다고 기록되어 있습니다.

충대머니에서는 이런 과거 데이터를 모두 긁어모아 하나의 커다란 **데이터 집합(data set)**으로 만들었습니다.

| 번호 | 나이 | 연봉(백만원) | 이행여부 |
|---|---|---|---|
| 1 | 29세 | 59 | 이행 O |
| 2 | 64세 | 89 | 이행 O |
| 3 | 33세 | 17| 이행 X|
| 4 | 45세 | 94 | 이행 O |
| 5 | 24세 | 26 | 이행 X |
| 6 | 55세 | 24 | 이행 X |
| 7 | 35세 | 52 | 이행 O |
| 8 | 57세 | 65 | 이행 O |
| 9 | 45세 | 32 | 이행 X|
| 10 | 52세 | 75 | 이행 O |
| 11 | 62세 | 31 | 이행 X |

## 러닝모델 

데이터 집합이 준비가 되었으면, **'뇌'**를 만들어줘야한다. 머신러닝에서는 이를 **러닝 모델(Learning Model)**이라 한다. 러닝 모델은 아주 간단히 말해서 하나의 커다란 함수로 구성되어 있다고 생각하면 된다. 즉, 함수의 수학적인 정의 = 어떠한 입력 변수에 대해서 특정한 연산을 수행한 결과를 출력 변수를 내뱉는 것과 동일하다고 보면 된다. 

위에서 설명했던 '나무 여부 구별 기계'의 경우에도 동일하게 러닝모델이 쓰인다.

'3개월 내 채무 이행 여부 예측 기계'의 경우, 입력 변수값이 신규 고객의 '나이'와 '연봉'이고, 출력 변수값이 채무 이행여부일 것이다. 즉, 우리가 설계한 러닝모델은 **입력 변수인 (연봉, 나이)로 채무이행 여부를 예측하는 모델이다.**

그렇다면? 구체적으로 러닝모델은 어떻게 생겼을까요?
아해의 플롯을 참고해봅시다. x1, x2(나이, 연봉) 이행 여부에 따라서 동그라미와 엑스표를 사용하였습니다.

![플롯1](http://research.sualab.com/assets/images/what-is-machine-learning/age-to-salary-plot.png)

이러한 플롯으로 나타낼 수 있으며, 어느 새로운 예시가 들어왔고 이 예시의 x1과 x2ㄱ의 값만 알때 점(x1, x2)가 O가 될지 X가 될지 예측하면 됩니다.
**이것을 더 자세히 말하자면, 원래 'O'가 모여있는 영역과 'X'가 모여있는 영역의 명확한 '경계'를 찾는 겁니다.**

## 선형모델

위 플롯에서 경계를 가장 간단하게 나눌 수 있는 방법은 직선을 긋는 것입니다. _(이렇게 데이터를 살펴보고, 처음에 경게를 어떻게 결정하면 좋을지 살펴보고 생각하는 과정은, 러닝 모델로 사용할 함수의 형태를 결정하는데 있어서 아주 중요합니다.)_ 이 부분은 아뢔 같은 함수로 생각할 수 있습니다.

![수식1](https://latex.codecogs.com/png.latex?f%5Cleft%28%20%7B%20x%20%7D_%7B%201%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%202%20%7D%20%5Cright%29%5Cquad%20%3D%5Cquad%20%7B%20w%20%7D_%7B%200%20%7D&plus;%7B%20w%20%7D_%7B%201%20%7D%7B%20x%20%7D_%7B%201%20%7D&plus;%7B%20w%20%7D_%7B%202%20%7D%7B%20x%20%7D_%7B%202%20%7D)

위 함수는 입력 변수가 x1, x2이며, 그 계구사 각각 w1, w2, 상수항이 w0인 함수입니다.
이는 우변을 0으로 놓으면 이를 만족하는 (x1, x2)는 곧 x1-x2 평면상에서의 직선이 됩니다.

이러한 직선의 형태로 정의되는 러닝 모델을 **선형 모델(Linear Model)**이라고 부르며, 이는 가장 단순한 러닝 모델에 해당합니다. 선형 모델을 사용하기로 결정하였으므로, 이제 이 직선의 위치와 기울기를 잘 조정하여 그 윗쪽에는 'O'집단이, 아랫쪽에는 'X' 집단이 위치할 수 있도록 분류할 수 있어야합니다. 즉, 위 함수에서 **w0, w1, w2**를 잘 찾아야 하는 것입니다.

이를 위해 w0, w1, w2의 초기값을 적절하게 잡아보겠습니다.

![플롯2](http://research.sualab.com/assets/images/what-is-machine-learning/age-to-salary-with-initialized-model-plot.png)

이를 보면, X와 O의 분류가 제대로 되지 않았음을 직관적으로 알 수 있고, 저희는 기울기를 낮춰야한다는 점을 알았습니다. 러닝 모델은 이에 결부된 모종의 **러닝 알고리즘(Learning Algorithm)**에 의거하여, w0, w1, w2의 값을 적절하게 조정, 잘못 분류된 점이 제대로 분류되도록 합니다.

![플롯3](http://research.sualab.com/assets/images/what-is-machine-learning/age-to-salary-with-improved-model-plot.png)

잘못 분류된 점의 수가 감소하였으나 여전히 잘못 분류된 점이 존재함을 알 수가 있습니다.
다시 한번 조정해봅니다.

![플롯4](http://research.sualab.com/assets/images/what-is-machine-learning/age-to-salary-with-learned-model-plot.png)

이제 완벽하게 분류되었음을 알 수가 있습니다. 이를 최종적인 함수 형태로 나타내면 다음과 같습니다.

![수식2](https://latex.codecogs.com/png.latex?f%5Cleft%28%20%7B%20x%20%7D_%7B%201%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%202%20%7D%20%5Cright%29%20%5Cquad%20%3D%5Cquad%20-50%5Cquad%20-%7B%20x%20%7D_%7B%201%20%7D&plus;2%7B%20x%20%7D_%7B%202%20%7D)


이제 이것이 어떻게 사용되는지 살펴봅시다. 신규 고객 '이선명'씨가 추가되었는데, 이 분의 나이가 23세이고, 연봉이 30백만원(3천만원)이라고 하면, 과연 3개월 내로 채무를 이행할 수 있을 까요? 우리가 학습시킨 모델에게 물어보자!

![수식3](https://latex.codecogs.com/png.latex?f%5Cleft%28%2040%2C%5Cquad%2040%20%5Cright%29%20%5Cquad%20%3D%5Cquad%20-50%5Cquad%20-40&plus;2%5Ccdot%2040%5Cquad%20%3C%5Cquad%200)


![플롯5](http://research.sualab.com/assets/images/what-is-machine-learning/age-to-salary-classify-sample-plot.png)

새로 찍은 이선명씨의 점이 러닝 모델이 만들어낸 직선의 아랫쪽에 위치하므로, 'X'로 분류됨이 확인되었습니다. 즉, 이선명 씨는 3개월 내로 채무를 이행할 수 없을 것으로 예측되므로, 고강도의 조치를 취해야함이 확인되었습니다.

그렇다면? 초기에 주어졌던 **나무 구별하는 문제**에 대해서는 어떻게 적용할 수 있을까요?
먼저 데이터를 기계가 이해할 수 있는 형태로 수치화시켜야 합니다.
채무 이행 여부 예측 기계의 경우, 애초부터 '나이'나 '연봉'처럼 이미 수치화된 정보를 사용했기 때문에 러닝 모델에 바로 입력하는데 무리가 없었습니다. 하지만, 이미지의 경우
사람은 직관적으로 이해할 수 있지만 기계는 그렇지 못합니다.

그래서 이미지의 경우, 다음과 같은 방법을 먼저 데이터를 '수치화'시키는 과정을 거쳐야 합니다. 먼저, 주어진 이미지를 픽셀 단위로 잘게 자릅니다. 그런 후 각 픽셀이 어떤 색상을 나타내는지를 [RGB 가산혼합 방식](https://ko.wikipedia.org/wiki/RGB_%EA%B0%80%EC%82%B0%ED%98%BC%ED%95%A9)으로 나타냅니다. 이미지의 특정 픽셀 위치를 '이미지 맨 위에서 부터 Y번째, 맨 왼쪽에서부터 X번째' 식으로 생각하면 (X, Y)와 같이 좌표 형태로 나타낼 수 있을 것인데, 예를 들면 (53, 141)에 위치한 픽셀의 RGB 값은 [77, 140, 86]이 되는 식입니다.

![나무그림](http://research.sualab.com/assets/images/what-is-machine-learning/isTree-classifier-pixels.png)

이미지 해상도가 100*150이면, 15,000개 정도의 픽셀을 갖고있습니다.
픽셀의 각각의 RGB 값을 위치에 따라 아래와 같이 일렬로 정리해 놓은 것을 데이터로 활용한다고 생각하면 됩니다.


| 픽셀 번호(X, Y) | R | G | B |
|---|---|---|---|
| 1 (1,1) | 255 | 255 | 255 |
| 2 (1,2| 255 | 254 | 192 |
| 3 (1,3)| 249 | 253 | 187 |
| 4 (1,4)| 237 | 211 | 209 |
| ...| ... | ... | ... |
| 14997 | 97 | 0 | 35 |
| 14998 | 27 | 188 | 70 |
| 14999 | 64 | 192 | 66 |
| 15000 | 0 | 0 | 1 |

이렇게 나타낼 수 있으며 그렇다면 러닝 모델은 무엇을 사용해야 할까요?
우리가 배운 선형모델을 사용해봅시다. 15,000개의 데이터 집합에 R,G,B 세개의 값이 있으므로 입력변수는 15,000 * 4 = 45,000개의 입력 변수가 필요합니다.

![수식4](https://latex.codecogs.com/png.latex?f%5Cleft%28%20%7B%20x%20%7D_%7B%201%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%202%20%7D%2C%5Cquad%20%5Cdots%20%5Cquad%20%2C%5Cquad%20%7B%20x%20%7D_%7B%2045000%20%7D%20%5Cright%29%20%3D%7B%20w%20%7D_%7B%200%20%7D&plus;%5Cquad%20%7B%20w%20%7D_%7B%201%20%7D%7B%20x%20%7D_%7B%201%20%7D&plus;%7B%20w%20%7D_%7B%202%20%7D%7B%20x%20%7D_%7B%202%20%7D&plus;%5Cquad%20%5Cdots%20%5Cquad%20&plus;%5Cquad%20%7B%20w%20%7D_%7B%2045000%20%7D%7B%20x%20%7D_%7B%2045000%20%7D)

우선 입력 변수가 45,000개인 함수의 경우, 3차원을 넘어가 버리기 때문에 앞에서처럼 평면 혹은 공간 상에서 가시적으로 표현할 수가 없으므로 사람이 이해하기가 어렵습니다.
뿐만 아니라 조정해야 할 계수들이 무려 45,001개로 너무 많기 때문에, 러닝 알고리즘에 의해 학습하는 데도 엄청나게 오랜 시간이 걸리거나, 최악의 경우 아예 학습 자체가 불가능할 수도 있습니다.

## 첫번째 시도 : 새로운 요인 정의 

그래서 보통 맨 첫 번쨰로, 러닝 모델의 입력 변수를 줄이는 시도를 해보고자 합니다.
예를 들어 15,000개의  픽셀들의 [R, G, B] 값 각각에 대하여, 이들의 평균값을 대표로 사용하면 어떨까요? 이렇게 하면, 픽셀의 위치와는 무관하게 다음과 같이 [R, G, B] 조합 한 개만이 얻어질 것입니다.

| 픽셀 번호(X, Y) | R의 평균| G의 평균 | B의 평균 |
|---|---|---|---|
| N/A | 192.34 | 34.56 | 11.67 |

이렇게 원 데이터에서 'R의 평균', 'G의 평균', 'B의 평균'과 같이, 데이터를 설명하는 새로운 항목들을 정의하여 위와 같이 새로운 형태의 데이터를 생성함으로써 입력 변수의 개수를 감소시키는 작업은 머신러닝에서 필수적이라고 할 수 있는데, 이 때의 항목을 **요인(feature)**이라고 부릅니다. 이렇게 새로 생성된 3개의 요인을 추출하여, 이를 선형 모델에 주고 학습시키고자 할 경우, 단 3개의 입력 변수를 가지는 선형 모델을 활용할 수 있으며, 단 4개의 계수만을 조정하면 됩니다.

![수식5](https://latex.codecogs.com/png.latex?f%5Cleft%28%20%7B%20x%20%7D_%7B%201%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%202%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%203%20%7D%20%5Cright%29%20%3D%7B%20w%20%7D_%7B%200%20%7D&plus;%5Cquad%20%7B%20w%20%7D_%7B%201%20%7D%7B%20x%20%7D_%7B%201%20%7D&plus;%7B%20w%20%7D_%7B%202%20%7D%7B%20x%20%7D_%7B%202%20%7D&plus;%7B%20w%20%7D_%7B%203%20%7D%7B%20x%20%7D_%7B%203%20%7D)

하지만, 이 값에 대한 의미를 다시 생각해보면, 입력 변수를 줄여줄 지언정, 원래의 목표인 '나무 여부 구별'측면에서는 쓸모가 없어져 버립니다. 전체 이미지를 지배하는 _평균 색상_이 무엇인지를 구했을 뿐, 평균을 구하는 과정에서 이미지 상의 '어느 지점의 색성이 무엇인지'의 정보가 모두 소멸되어 버렸기 때문입니다.

> 사람조차도, 이 정보만으로는 마무 여부를 구별할 수가 없습니다.


좀 더 발전시킬 수 있는 요인을 생각해보면, 주어진 이미지를 수평 방향으로 반으로 갈라서 윗쪽 절반의 정중앙에 해당하는 픽셀을 선택하여 해당 픽셀의 [R, G, B]값과 아랫쪽 절반의 정중앙 픽셀을 선택하여 해당 픽셀의 [R, G, B]값을 각각 요인으로 정의할 수 있습니다. 이는 아래와 같이 볼 수 있습니다.


| 픽셀 위치 | R | G | B |
|---|---|---|---|
| 윗쪽 중앙 | 77 | 215 | 86 |
| 아랫쪽 중앙 | 49 | 55 | 33 |

이렇게 하면 총 6개의 입력 변수를 가지는 선형 모델을 활용하여, 7개의 계수를 조정하면 됩니다.

![수식6](https://latex.codecogs.com/png.latex?f%5Cleft%28%20%7B%20x%20%7D_%7B%201%20%7D%2C%5Cquad%20%7B%20x%20%7D_%7B%202%20%7D%2C%5Cdots%20%2C%7B%20x%20%7D_%7B%206%20%7D%20%5Cright%29%20%3D%7B%20w%20%7D_%7B%200%20%7D&plus;%5Cquad%20%7B%20w%20%7D_%7B%201%20%7D%7B%20x%20%7D_%7B%201%20%7D&plus;%7B%20w%20%7D_%7B%202%20%7D%7B%20x%20%7D_%7B%202%20%7D&plus;%7B%20%5Cdots%20&plus;w%20%7D_%7B%206%20%7D%7B%20x%20%7D_%7B%206%20%7D)

필자가 막 지어낸 엄청나게 허접해보이는(?) 요인이지만, 적어도 제 생각에는 앞선 ‘RGB 평균값’ 요인보다는 이게 더 나을 것 같습니다. 일반적인 나무 이미지를 생각해보면, 윗쪽 중앙에는 무성한 초록색 잎사귀가 위치해 있고, 아랫쪽 중앙에는 줄기가 위치해 있지 않았던가요? 이 때문에 나무 이미지의 경우 윗쪽 중앙의 [R, G, B] 값이 녹색에 해당하는 값에 가까울 것이고, 아랫쪽 중앙의 [R, G, B] 값은 갈색에 해당하는 값에 가까울 것입니다. 러닝 모델은 6개의 입력 변수로부터 이러한 경향을 받아들인 뒤, 이러한 특성을 잘 설명할 수 있는 방향으로 계수를 조절할 것으로 기대할 수 있습니다.

![그림1](http://research.sualab.com/assets/images/what-is-machine-learning/isTree-classifier-successful-features.png)

참고로, 위에서 소개한 2가지 요인은 이해를 돕기 위한 요인들이며, **실제 이미지 인식(Image Recognition)** 문제에서는 절대 사용하지 않습니다. 실제의 요인 추출 기법은 대부분 이미지 상의 픽셀들을 영역별, 혹은 종적/횡적으로 스캔하면서 이 과정에서 픽셀 강도의 변화 경향을 추적 후, 이를 수치화시킨 형태로 정의합니다.

![그림2](http://research.sualab.com/assets/images/what-is-machine-learning/image-feature-extractors.png)

> 이미지 인식 분야에서의 대표적인 요인 추출 알고리즘

머신러닝에서 러닝 모델을 성공적으로 학습하기 위해서는 효과적인 요인을 잘 정의하는 것이 대단히 중요한데, 이는 해당 분야에 대한 풍부한 지식과 뛰어난 직관에 힘입은, 가히 예술에 가까운 작업이라고 할 수 있습니다. 실제로 ‘나무 여부 구별’이나 ‘채무 이행여부 예측’ 따위의 문제에 있어서, ‘어떤 요인을 정의해서 기계를 학습했더니 성능이 월등하게 잘 나왔더라’와 같은 내용의 연구 결과가 하나의 논문거리가 되는 경우가 허다합니다.

## 두번째 시도 : 선형 모델 외의 다른 러닝 모델 사용

사실, 오늘날 이미지 인식 분야에서는 선형 모델을 잘 쓰지 않습니다. 선형 모델은 가장 단순하고 (선형 모델로 학습이 가능한 데이터 집합에 한해서) 학습 속도가 빠르며 인간이 이해하기 쉬운 대신, 원 데이터 자체가 수많은 픽셀로 이루어져 있는 이미지와 같은 데이터의 경우에는 데이터의 복잡성을 선형 모델에 충분히 반영하는 것이 불가능합니다. 반면 예시2에서와 같이 애초에 원 데이터 자체가 ‘나이’, ‘연봉’ 등 적은 수의 요인들로 구성되어 있는 경우, 선형 모델을 충분히 적용해 볼 만합니다.

그래서, 실제 이미지 인식 분야에서는 선형 모델 대신 인공신경망(artificial neural networks)과 같은 복잡성이 높은 러닝 모델을 사용합니다. 이렇게 복잡성이 높은 신경망(neural networks) 구조를 러닝 모델로 사용하는 머신러닝 패러다임을 **‘딥 러닝(deep learning)‘** 이라고 합니다.


![그림3](http://research.sualab.com/assets/images/what-is-machine-learning/learning-models-and-algorithms.png)

---

앞으로는 딥러닝에 대한 스터디가 이어질 예정입니다.
